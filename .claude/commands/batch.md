---
description: 自动识别当前进度并批量执行多个行动
---

## 执行流程

1. **检查项目宪法**:
   - 读取宪法文件 `specify/constitution.md`（如存在）
   - 确保后续操作符合宪法约束

2. **获取当前主题**:
   - 扫描 `specify/` 目录找到最新主题目录（按序号排序）
   - 读取最新主题目录下的 `discuss.md` 文件了解内容
   - 如无主题目录则提示运行 `/new-topic` 并结束命令

3. **读取研究基础**:
   - 读取 `specify/{当前主题目录}/research.md` 文件（如存在）
   - 如研究文件不存在则建议先运行 `/research`
   - 基于现有研究结果分析项目现状

4. **读取行动列表**:
   - 读取 `specify/{当前主题目录}/plan.md` 文件
   - 如行动文件不存在则提示运行 `/plan` 并结束命令
   - 解析行动列表，提取所有行动项及其状态

5. **识别待执行行动**:
   - 查找"⏳待执行"或"🔄进行中"行动项（按编号 A01, A02, A03...）
   - 如所有行动都已完成则显示完成状态并结束命令
   - 优先处理"🔄进行中"的行动，然后按编号顺序取出最多5个待执行行动

6. **读取实现记录**:
   - 读取 `specify/{当前主题目录}/implementation/` 目录下已完成行动的实现记录（如存在）

7. **批量执行行动**:
   - 对每个待执行行动依次进行：
     * 综合分析行动描述、主题、已有讨论、研究基础、实现记录
     * 结合项目源码和代码结构制定实施方案
     * **严格遵循项目宪法约束**
     * 逐步实施更改和测试验证
     * 根据完成情况更新状态为"✅已完成"或"🔄进行中"

8. **生成或更新实现记录**:
   - 为每个已执行行动生成或更新实现记录：
     * 在 `specify/{当前主题目录}/` 下创建 `implementation/` 目录（如不存在）
     * 读取模板文件 `.specify/implementation-template.md`
     * 替换模板占位符：
       - `{{ACTION_ID}}` → 行动编号
       - `{{ACTION_DESCRIPTION}}` → 行动描述
       - `{{IMPLEMENTATION_DETAILS}}` → 详细实现细节（包含变更的代码段，如为🔄进行中则说明已完成和未完成部分）
       - `{{CURRENT_DATE}}` → 当前日期（YYYY-MM-DD）
     * 生成目标文件 `specify/{当前主题目录}/implementation/{ACTION_ID}.md`（如文件已存在则覆盖）

9. **更新行动计划**:
   - 更新 `specify/{当前主题目录}/plan.md` 文件中所有已完成行动的状态

## 输出结果
- 执行的行动编号和描述
- 每个行动的完成状态（✅已完成 或 🔄进行中）
- 如有🔄进行中行动，说明已完成和未完成部分
- 如还有待执行行动则建议继续执行 `/action` 或 `/batch`